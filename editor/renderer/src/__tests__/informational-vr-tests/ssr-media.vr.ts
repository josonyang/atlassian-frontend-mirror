import type { Locator, Page } from '@playwright/test';
import { snapshotInformational } from '@af/visual-regression';
import { MediaSSR } from './ssr-media.fixture';

// TODO: UTEST-1409
// Gemini does not allow test that relies on network assets (too Flaky)
// We may need to change the code to enable those tests
// Re-enable test and delete packages/editor/renderer/src/__tests__/visual-regression/media/ssr-media.ts once request mocking is supported
snapshotInformational.skip(MediaSSR, {
	description: 'Media SSR Renderer tests',

	prepare: async (page: Page, component: Locator) => {
		const media = page.locator('[data-testid="media-image"]');
		await page.evaluate(() => window.scrollTo(0, Number.MAX_SAFE_INTEGER));
		await media.nth(0).waitFor({ state: 'visible' });
		await media.nth(1).waitFor({ state: 'visible' });
		await media.nth(2).waitFor({ state: 'visible' });
		await media.nth(3).waitFor({ state: 'visible' });
		await media.nth(4).waitFor({ state: 'visible' });
		await media.nth(5).waitFor({ state: 'visible' });
	},

	ignoredErrors: [
		{
			// Ignored via go/ees005
			// eslint-disable-next-line require-unicode-regexp
			pattern: /useLayoutEffect does nothing on the server/,
			ignoredBecause:
				'This warning is generated by our testing example component and is carried over from the 101-media-ssr example',
			jiraIssueId: 'TODO-1',
		},
		{
			// Ignored via go/ees005
			// eslint-disable-next-line require-unicode-regexp
			pattern: /Text content did not match/,
			ignoredBecause:
				'This warning is generated by our testing example component and is carried over from the 101-media-ssr example',
			jiraIssueId: 'TODO-1',
		},
	],
});
